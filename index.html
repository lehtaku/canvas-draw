<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Draw</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <link rel="stylesheet" href="./styles.css" type="text/css">
</head>
<body>

<div class="column">
    <button class="color-button" id="#FF4136" style="background-color: #FF4136; color: #800600">Red</button>
    <button class="color-button" id="#0074D9" style="background-color: #0074D9; color: #B3DBFF">Blue</button>
    <button class="color-button" id="#FFDC00" style="background-color: #FFDC00; color: #0E3E14">Yellow</button>
    <button class="color-button" id="#2ECC40" style="background-color: #2ECC40; color: #665800">Green</button>
</div>

<div class="column">
    <div class="slide-container">
        <h4 id="brush-size-text">Brush size: 8px</h4>
        <input type="range" min="1" max="5" value="2" class="size-slider" id="brush-size">
    </div>
</div>

<div class="column">
        <canvas id="drawCanvas" width="800" height="600"></canvas>
</div>

<div class="column">
    <button id="clear" type="button" class="clear-button">Clear Canvas</button>
</div>


<script>
    $(document).ready(function () {

        let ctx = document.getElementById('drawCanvas').getContext('2d')
        ctx.strokeStyle = '#FF4136'
        ctx.lineWidth = 8
        ctx.lineCap = 'round'

        let mouseDown = false
        let mouseX = 0
        let mouseY = 0

        function setSize(size) {
            ctx.lineWidth = size
            $('#brush-size-text').text("Brush size: " + size + 'px')
        }

        function drawLine(fromX, fromY, toX, toY) {
            let fixerNum = (ctx.lineWidth / 2)
            ctx.beginPath()
            ctx.moveTo(fromX + fixerNum, fromY + fixerNum)
            ctx.lineTo(toX + fixerNum, toY + fixerNum)
            ctx.stroke()
        }

        // Follow mouse events
        $('#drawCanvas').mousedown(function (event) {
            mouseDown = true

            let fixerNum = (ctx.lineWidth / 2)

            ctx.beginPath()
            ctx.arc(event.offsetX + fixerNum, event.offsetY + fixerNum, 1, 0, 2 * Math.PI)
            ctx.stroke()

            mouseX = event.offsetX
            mouseY = event.offsetY

        }).mousemove(function (event) {
            if (mouseDown) {
                drawLine(mouseX, mouseY, event.offsetX, event.offsetY)
                mouseX = event.offsetX
                mouseY = event.offsetY
            }
        }).mouseup(function () {
            mouseDown = false
        }).mouseenter(function () {
            let color = ctx.strokeStyle.toUpperCase().slice(1)
            $(this).css('cursor', `url('./cursors/${color}-${ctx.lineWidth}.png'), pointer`)
        }).mouseleave(function () {
            $(this).css('cursor', 'auto')
        })

        // Change color
        $('.color-button').click(function () {
            ctx.strokeStyle = $(this).attr('id')
        })

        $('#brush-size').on('input', function (event) {
            switch(parseInt(event.target.value)) {
                case 1 :
                    setSize(2)
                break
                case 2 :
                    setSize(8)
                break
                case 3 :
                    setSize(16)
                break
                case 4 :
                    setSize(32)
                break
                case 5 :
                    setSize(48)
                    break
                default:
                    setSize(1)
            }
        })

        // Clear canvas
        $('#clear').click(function () {
            ctx.clearRect(0, 0, 800, 600)
        })
    })
</script>

</body>
</html>
